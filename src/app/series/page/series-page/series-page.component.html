<app-app-header [user]="user$ | async"></app-app-header>

<div class="series-page page-with-header">
    <app-series-header
        [seriesHeader]="seriesHeader$ | async"
    ></app-series-header>

    <ng-container *ngIf="isAuthenticated$ | async">
        <div class="flex align-center" style="margin-top: 32px;">
            <h4 style="margin-top: 0; margin-bottom: 0; margin-right: 20px;">Are you part of this series?</h4>

            <button
                *ngIf="ownerEmail$ | async as ownerEmail"
                mat-raised-button
                color="accent"
                (click)="connectToOtherUser(ownerEmail)"
            >
                CONNECT NOW
            </button>
        </div>
    </ng-container>

    <h2>
        Current leaderboard
    </h2>

    <div class="leaderboard">
        <app-leaderboard
            [leaderboard]="leaderboard$ | async"
            [series]="series$ | async"
            [myEmail]="myEmail$ | async"
        ></app-leaderboard>

        <div class="legend-wrapper">
            <div class="legend"></div>
            Current Finalist
        </div>
    </div>

    <app-series-stats
        *ngIf="seriesStats$ | async as stats"
        [bestAverageRank]="stats.bestAverageRank"
        [mostPrices]="stats.mostPrices"
        [mostEffPrices]="stats.mostEffPrices"
        [mostRebuysAddons]="stats.mostRebuysAddons"
        [mostRebuysAddonsPerT]="stats.mostRebuysAddonsPerT"
        [mostITM]="stats.mostITM"
        [mostPercITM]="stats.mostPercITM"
        [mostSpilled]="stats.mostSpilled"
    ></app-series-stats>

    <h2>Tournaments</h2>

    <ng-container *ngFor="let tournament of tournaments$ | async">
        <app-series-tournament
            [test]="tournament"
            [myEmail]="myEmail$ | async"
        ></app-series-tournament>
    </ng-container>

</div>
